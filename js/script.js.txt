```javascript
/**
 * SPÅYW MAÅA PANEW - SCRIPT.JS
 * Vanilla JavaScript - bez zaleÅ¼noÅ›ci
 */

document.addEventListener('DOMContentLoaded', function() {
    
    // ============================================
    // ZMIENNE GLOBALNE
    // ============================================
    const navbar = document.getElementById('navbar');
    const hamburger = document.getElementById('hamburger');
    const navLinks = document.getElementById('navLinks');
    const backToTop = document.getElementById('backToTop');
    const lightbox = document.getElementById('lightbox');
    const bookingForm = document.getElementById('bookingForm');
    
    // ============================================
    // 1. SMOOTH SCROLL
    // ============================================
    function initSmoothScroll() {
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                const targetId = this.getAttribute('href');
                if (targetId === '#') return;
                
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    e.preventDefault();
                    
                    const navHeight = navbar.offsetHeight;
                    const targetPosition = targetElement.offsetTop - navHeight;
                    
                    window.scrollTo({
                        top: targetPosition,
                        behavior: 'smooth'
                    });
                    
                    // Zamknij mobile menu jeÅ›li otwarte
                    if (navLinks.classList.contains('active')) {
                        toggleMobileMenu();
                    }
                    
                    // Aktualizuj aktywny link
                    updateActiveNavLink(targetId);
                }
            });
        });
    }
    
    function updateActiveNavLink(activeId) {
        document.querySelectorAll('.nav-links a').forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href') === activeId) {
                link.classList.add('active');
            }
        });
    }
    
    // ============================================
    // 2. MOBILE MENU TOGGLE
    // ============================================
    function toggleMobileMenu() {
        hamburger.classList.toggle('active');
        navLinks.classList.toggle('active');
        document.body.classList.toggle('menu-open');
    }
    
    function initMobileMenu() {
        if (!hamburger) return;
        
        hamburger.addEventListener('click', toggleMobileMenu);
        
        // Zamknij menu przy klikniÄ™ciu poza nim
        document.addEventListener('click', function(e) {
            if (!hamburger.contains(e.target) && !navLinks.contains(e.target)) {
                if (navLinks.classList.contains('active')) {
                    toggleMobileMenu();
                }
            }
        });
        
        // Zamknij menu przy resize na desktop
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768 && navLinks.classList.contains('active')) {
                toggleMobileMenu();
            }
        });
    }
    
    // ============================================
    // 3. GALERIA LIGHTBOX
    // ============================================
    let currentImageIndex = 0;
    let galleryImages = [];
    
    function initLightbox() {
        const galleryItems = document.querySelectorAll('.gallery-item');
        galleryImages = Array.from(galleryItems).map(item => ({
            src: item.querySelector('img').src,
            title: item.querySelector('.gallery-title')?.textContent || ''
        }));
        
        galleryItems.forEach((item, index) => {
            item.addEventListener('click', () => openLightbox(index));
        });
        
        // Przycisk zamkniÄ™cia
        const closeBtn = lightbox?.querySelector('.lightbox-close');
        if (closeBtn) {
            closeBtn.addEventListener('click', closeLightbox);
        }
        
        // KlikniÄ™cie poza obrazem zamyka lightbox
        lightbox?.addEventListener('click', function(e) {
            if (e.target === lightbox) {
                closeLightbox();
            }
        });
        
        // Nawigacja klawiaturÄ…
        document.addEventListener('keydown', handleLightboxKeys);
        
        // Swipe na mobile
        initLightboxSwipe();
    }
    
    function openLightbox(index) {
        if (!lightbox) return;
        
        currentImageIndex = index;
        updateLightboxImage();
        
        lightbox.classList.add('active');
        document.body.style.overflow = 'hidden';
        
        // Fokus na lightbox dla accessibility
        lightbox.setAttribute('tabindex', '-1');
        lightbox.focus();
    }
    
    function closeLightbox() {
        if (!lightbox) return;
        
        lightbox.classList.remove('active');
        document.body.style.overflow = '';
    }
    
    function updateLightboxImage() {
        const img = lightbox.querySelector('.lightbox-img');
        const imageData = galleryImages[currentImageIndex];
        
        // Fade out
        img.style.opacity = '0';
        
        setTimeout(() => {
            img.src = imageData.src;
            img.alt = imageData.title;
            // Fade in
            img.style.opacity = '1';
        }, 150);
    }
    
    function nextImage() {
        currentImageIndex = (currentImageIndex + 1) % galleryImages.length;
        updateLightboxImage();
    }
    
    function prevImage() {
        currentImageIndex = (currentImageIndex - 1 + galleryImages.length) % galleryImages.length;
        updateLightboxImage();
    }
    
    function handleLightboxKeys(e) {
        if (!lightbox?.classList.contains('active')) return;
        
        switch(e.key) {
            case 'Escape':
                closeLightbox();
                break;
            case 'ArrowRight':
                nextImage();
                break;
            case 'ArrowLeft':
                prevImage();
                break;
        }
    }
    
    function initLightboxSwipe() {
        let touchStartX = 0;
        let touchEndX = 0;
        
        lightbox?.addEventListener('touchstart', function(e) {
            touchStartX = e.changedTouches[0].screenX;
        }, { passive: true });
        
        lightbox?.addEventListener('touchend', function(e) {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        }, { passive: true });
        
        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;
            
            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    nextImage(); // Swipe left -> next
                } else {
                    prevImage(); // Swipe right -> prev
                }
            }
        }
    }
    
    // ============================================
    // 4. WALIDACJA FORMULARZA
    // ============================================
    function initFormValidation() {
        if (!bookingForm) return;
        
        const inputs = {
            name: document.getElementById('name'),
            email: document.getElementById('email'),
            phone: document.getElementById('phone'),
            date: document.getElementById('date'),
            people: document.getElementById('people'),
            route: document.getElementById('route')
        };
        
        // Real-time walidacja
        Object.values(inputs).forEach(input => {
            if (!input) return;
            input.addEventListener('blur', () => validateField(input));
            input.addEventListener('input', () => clearError(input));
        });
        
        bookingForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            let isValid = true;
            
            // Walidacja wszystkich pÃ³l
            Object.values(inputs).forEach(input => {
                if (input && !validateField(input)) {
                    isValid = false;
                }
            });
            
            if (isValid) {
                submitForm();
            } else {
                // PrzewiÅ„ do pierwszego bÅ‚Ä™du
                const firstError = bookingForm.querySelector('.error');
                if (firstError) {
                    firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }
        });
    }
    
    function validateField(field) {
        clearError(field);
        
        const value = field.value.trim();
        let isValid = true;
        let errorMessage = '';
        
        switch(field.id) {
            case 'name':
                if (value.length < 2) {
                    isValid = false;
                    errorMessage = 'ImiÄ™ musi mieÄ‡ co najmniej 2 znaki';
                } else if (!/^[a-zA-ZÄ…Ä‡Ä™Å‚Å„Ã³Å›ÅºÅ¼Ä„Ä†Ä˜ÅÅƒÃ“ÅšÅ¹Å»\s-]+$/.test(value)) {
                    isValid = false;
                    errorMessage = 'ImiÄ™ moÅ¼e zawieraÄ‡ tylko litery';
                }
                break;
                
            case 'email':
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(value)) {
                    isValid = false;
                    errorMessage = 'Podaj prawidÅ‚owy adres email';
                }
                break;
                
            case 'phone':
                const phoneRegex = /^[\d\s\+\-\(\)]{9,}$/;
                if (!phoneRegex.test(value)) {
                    isValid = false;
                    errorMessage = 'Podaj prawidÅ‚owy numer telefonu';
                }
                break;
                
            case 'date':
                if (!value) {
                    isValid = false;
                    errorMessage = 'Wybierz datÄ™ spÅ‚ywu';
                } else {
                    const selectedDate = new Date(value);
                    const tomorrow = new Date();
                    tomorrow.setDate(tomorrow.getDate() + 1);
                    tomorrow.setHours(0, 0, 0, 0);
                    
                    if (selectedDate < tomorrow) {
                        isValid = false;
                        errorMessage = 'Data musi byÄ‡ od jutra';
                    }
                }
                break;
                
            case 'people':
                const peopleNum = parseInt(value);
                if (!value || peopleNum < 1) {
                    isValid = false;
                    errorMessage = 'Minimum 1 osoba';
                } else if (peopleNum > 50) {
                    isValid = false;
                    errorMessage = 'Maksimum 50 osÃ³b (skontaktuj siÄ™ dla wiÄ™kszej grupy)';
                }
                break;
                
            case 'route':
                if (!value) {
                    isValid = false;
                    errorMessage = 'Wybierz trasÄ™';
                }
                break;
        }
        
        if (!isValid) {
            showError(field, errorMessage);
        }
        
        return isValid;
    }
    
    function showError(field, message) {
        field.classList.add('error');
        
        let errorEl = field.parentElement.querySelector('.error-message');
        if (!errorEl) {
            errorEl = document.createElement('span');
            errorEl.className = 'error-message';
            errorEl.style.cssText = 'color: #ef4444; font-size: 0.875rem; margin-top: 0.25rem; display: block;';
            field.parentElement.appendChild(errorEl);
        }
        errorEl.textContent = message;
        
        // ARIA dla accessibility
        field.setAttribute('aria-invalid', 'true');
        field.setAttribute('aria-describedby', `error-${field.id}`);
        errorEl.id = `error-${field.id}`;
    }
    
    function clearError(field) {
        field.classList.remove('error');
        field.removeAttribute('aria-invalid');
        field.removeAttribute('aria-describedby');
        
        const errorEl = field.parentElement.querySelector('.error-message');
        if (errorEl) {
            errorEl.remove();
        }
    }
    
    function submitForm() {
        const submitBtn = bookingForm.querySelector('.form-submit');
        const originalText = submitBtn.innerHTML;
        
        // Loading state
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<span>WysyÅ‚anie...</span>';
        
        // Symulacja wysyÅ‚ania (zamieÅ„ na fetch w produkcji)
        setTimeout(() => {
            submitBtn.innerHTML = '<span>âœ“ WysÅ‚ano!</span>';
            submitBtn.style.background = '#10b981';
            
            // Reset formularza
            setTimeout(() => {
                bookingForm.reset();
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalText;
                submitBtn.style.background = '';
                
                // PokaÅ¼ potwierdzenie
                showNotification('Rezerwacja wysÅ‚ana! Skontaktujemy siÄ™ w ciÄ…gu 24h.', 'success');
            }, 1500);
        }, 1500);
    }
    
    function showNotification(message, type = 'success') {
        const notification = document.createElement('div');
        notification.className = `notification notification-${type}`;
        notification.style.cssText = `
            position: fixed;
            top: 100px;
            right: 20px;
            background: ${type === 'success' ? '#10b981' : '#ef4444'};
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            z-index: 3000;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            animation: slideInRight 0.3s ease;
        `;
        notification.textContent = message;
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
            notification.style.animation = 'slideOutRight 0.3s ease';
            setTimeout(() => notification.remove(), 300);
        }, 5000);
    }
    
    // ============================================
    // 5. DATEPICKER (min data = jutro)
    // ============================================
    function initDatepicker() {
        const dateInput = document.getElementById('date');
        if (!dateInput) return;
        
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        
        const yyyy = tomorrow.getFullYear();
        const mm = String(tomorrow.getMonth() + 1).padStart(2, '0');
        const dd = String(tomorrow.getDate()).padStart(2, '0');
        
        dateInput.min = `${yyyy}-${mm}-${dd}`;
        
        // Dodaj placeholder dla przeglÄ…darek bez natywnego datepickera
        if (!isDateInputSupported()) {
            dateInput.placeholder = 'RRRR-MM-DD';
        }
    }
    
    function isDateInputSupported() {
        const input = document.createElement('input');
        input.setAttribute('type', 'date');
        return input.type === 'date';
    }
    
    // ============================================
    // 6. SCROLL ANIMACJE (Intersection Observer)
    // ============================================
    function initScrollAnimations() {
        const animatedElements = document.querySelectorAll('.animate-on-scroll');
        
        const observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0.1
        };
        
        const observer = new IntersectionObserver((entries, obs) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                    
                    // Opcjonalnie: przestaÅ„ obserwowaÄ‡ po animacji
                    // obs.unobserve(entry.target);
                }
            });
        }, observerOptions);
        
        animatedElements.forEach(el => observer.observe(el));
        
        // Dodaj klasy do sekcji
        document.querySelectorAll('.section').forEach((section, index) => {
            section.classList.add('animate-on-scroll');
            section.style.transitionDelay = `${index * 0.1}s`;
        });
    }
    
    // ============================================
    // 7. PARALLAX EFEKT NA HERO
    // ============================================
    function initParallax() {
        const heroBg = document.querySelector('.hero-bg');
        if (!heroBg) return;
        
        let ticking = false;
        
        function updateParallax() {
            const scrolled = window.pageYOffset;
            const rate = scrolled * 0.4;
            
            // Subtelny parallax - tylko gdy hero jest widoczny
            if (scrolled < window.innerHeight) {
                heroBg.style.transform = `translateY(${rate}px) scale(1.1)`;
            }
            
            ticking = false;
        }
        
        window.addEventListener('scroll', function() {
            if (!ticking) {
                window.requestAnimationFrame(updateParallax);
                ticking = true;
            }
        }, { passive: true });
        
        // Inicjalne ustawienie
        updateParallax();
    }
    
    // ============================================
    // DODATKOWE FUNKCJE
    // ============================================
    
    // Navbar scroll effect
    function initNavbarScroll() {
        let lastScroll = 0;
        
        window.addEventListener('scroll', function() {
            const currentScroll = window.pageYOffset;
            
            // Dodaj/ usuÅ„ klasÄ™ scrolled
            if (currentScroll > 50) {
                navbar.classList.add('scrolled');
            } else {
                navbar.classList.remove('scrolled');
            }
            
            // Ukryj/pokaÅ¼ navbar przy scrollowaniu w dÃ³Å‚/gÃ³rÄ™
            if (currentScroll > lastScroll && currentScroll > 200) {
                navbar.style.transform = 'translateY(-100%)';
            } else {
                navbar.style.transform = 'translateY(0)';
            }
            
            lastScroll = currentScroll;
            
            // Back to top button
            if (backToTop) {
                if (currentScroll > 500) {
                    backToTop.classList.add('visible');
                } else {
                    backToTop.classList.remove('visible');
                }
            }
        }, { passive: true });
        
        // Back to top click
        backToTop?.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
    }
    
    // FAQ Accordion
    function initFAQ() {
        const faqItems = document.querySelectorAll('.faq-item');
        
        faqItems.forEach(item => {
            const question = item.querySelector('.faq-question');
            
            question?.addEventListener('click', () => {
                const isActive = item.classList.contains('active');
                
                // Zamknij wszystkie
                faqItems.forEach(i => i.classList.remove('active'));
                
                // OtwÃ³rz klikniÄ™ty (jeÅ›li nie byÅ‚ aktywny)
                if (!isActive) {
                    item.classList.add('active');
                }
            });
        });
    }
    
    // Counter animation dla statystyk
    function initCounters() {
        const counters = document.querySelectorAll('.stat-number[data-count]');
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const counter = entry.target;
                    const target = parseInt(counter.dataset.count);
                    animateCounter(counter, target);
                    observer.unobserve(counter);
                }
            });
        }, { threshold: 0.5 });
        
        counters.forEach(counter => observer.observe(counter));
    }
    
    function animateCounter(element, target) {
        const duration = 2000;
        const step = target / (duration / 16);
        let current = 0;
        
        function update() {
            current += step;
            if (current < target) {
                element.textContent = Math.floor(current);
                requestAnimationFrame(update);
            } else {
                element.textContent = target;
            }
        }
        
        update();
    }
    
    // ============================================
    // INICJALIZACJA
    // ============================================
    function init() {
        try {
            initSmoothScroll();
            initMobileMenu();
            initLightbox();
            initFormValidation();
            initDatepicker();
            initScrollAnimations();
            initParallax();
            initNavbarScroll();
            initFAQ();
            initCounters();
            
            console.log('ðŸš£ SpÅ‚yw MaÅ‚a Panew - strona gotowa!');
        } catch (error) {
            console.error('BÅ‚Ä…d inicjalizacji:', error);
        }
    }
    
    // Start
    init();
});

// ============================================
// STYLE DLA NOTYFIKACJI (dodawane dynamicznie)
// ============================================
const notificationStyles = document.createElement('style');
notificationStyles.textContent = `
    @keyframes slideInRight {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
    }
    @keyframes slideOutRight {
        from { transform: translateX(0); opacity: 1; }
        to { transform: translateX(100%); opacity: 0; }
    }
`;
document.head.appendChild(notificationStyles);
```
